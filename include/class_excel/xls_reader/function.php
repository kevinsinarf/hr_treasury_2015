<?
	global $th2unimap,$th2unimap2,$th2unimap3,$th2unimap4,$th2unimap5;

	$th2unimap = array( 
	'ก' => "&#3585;", 'ข' => "&#3586;", 'ฃ' => "&#3587;", 'ค' => "&#3588;", 'ฅ' => "&#3589;", 'ฆ' => "&#3590;", 'ง' => "&#3591;",
	'จ' => "&#3592;", 'ฉ' => "&#3593;", 'ช' => "&#3594;", 'ซ' => "&#3595;", 'ฌ' => "&#3596;", 'ญ' => "&#3597;", 'ฎ' => "&#3598;",
	'ฏ' => "&#3599;", 'ฐ' => "&#3600;", 'ฑ' => "&#3601;", 'ฒ' => "&#3602;", 'ณ' => "&#3603;", 'ด' => "&#3604;", 'ต' => "&#3605;",
	'ถ' => "&#3606;", 'ท' => "&#3607;", 'ธ' => "&#3608;", 'น' => "&#3609;", 'บ' => "&#3610;", 'ป' => "&#3611;", 'ผ' => "&#3612;",
	'ฝ' => "&#3613;", 'พ' => "&#3614;", 'ฟ' => "&#3615;", 'ภ' => "&#3616;", 'ม' => "&#3617;", 'ย' => "&#3618;", 'ร' => "&#3619;",
	'ฤ' => "&#3620;", 'ล' => "&#3621;", 'ฦ' => "&#3622;", 'ว' => "&#3623;", 'ศ' => "&#3624;", 'ษ' => "&#3625;", 'ส' => "&#3626;",
	'ห' => "&#3627;", 'ฬ' => "&#3628;", 'อ' => "&#3629;", 'ฮ' => "&#3630;", 'ฯ' => "&#3631;", 'ะ' => "&#3632;", 'ั' => "&#3633;",
	'า' => "&#3634;", 'ำ' => "&#3635;", 'ิ' => "&#3636;", 'ี' => "&#3637;", 'ึ' => "&#3638;", 'ื' => "&#3639;", 'ุ' => "&#3640;",
	'ู' => "&#3641;", 'ฺ' => "&#3642;", '฿' => "&#3647;", 'เ' => "&#3648;", 'แ' => "&#3649;", 'โ' => "&#3650;", 'ใ' => "&#3651;",
	'ไ' => "&#3652;", 'ๅ' => "&#3653;", 'ๆ' => "&#3654;", '็' => "&#3655;", '่' => "&#3656;", '้' => "&#3657;", '๊' => "&#3658;",
	'๋' => "&#3659;", '์' => "&#3660;", 'ํ' => "&#3661;", '๎' => "&#3662;", '๏' => "&#3663;", '๐' => "&#3664;", '๑' => "&#3665;",
	'๒' => "&#3666;", '๓' => "&#3667;", '๔' => "&#3668;", '๕' => "&#3669;", '๖' => "&#3670;", '๗' => "&#3671;", '๘' => "&#3672;",
	'๙' => "&#3673;", '๚' => "&#3674;", '๛' => "&#3675;");
	
	$th2unimap2 = array( // สำหรับไม่มีสระอยู่ข้างหน้า
	'่' => "&#63242;", 
	'้' => "&#63243;", 
	'๊' => "&#63244;",
	'๋' => "&#63245;", 
	'์' => "&#63246;"
	);
	
	$th2unimap3 = array( // สำหรับมี อักษรมีหางอยู่ข้างหน้า
	'ิ' => "&#63233;",
	'ี' => "&#63234;", 
	'ึ' => "&#63235;", 
	'ื' => "&#63236;",
	'่' => "&#63237;", 
	'้' => "&#63238;", 
	'๊' => "&#63239;",
	'๋' => "&#63240;", 
	'์' => "&#63241;",
	'ั' => "&#63248;",
	'ํ' => "&#63249;",
	'็' => "&#63250;"
	);
	
	$th2unimap4 = array( // สำหรับมี 2 อักษรมีหางอยู่ข้างหน้า และ 1 ตัวอักษรข้างหน้าเป็นสระบน
	'่' => "&#63251;", 
	'้' => "&#63252;", 
	'๊' => "&#63253;",
	'๋' => "&#63254;", 
	'์' => "&#63255;"
	);
	
	$th2unimap5 = array( // สำหรับ ญ ฐ ร่วมกับ สระอุ อู และ อฺ
	'ญ' => "&#63247;", 
	'ฐ' => "&#63232;", 
	);
	
	$th2unimap6 = array( // สำหรับ อักษรภาษาอังกฤษและอักขระพิเศษ
	' ' => "&#32;", '!' => "&#33;", '"' => "&#34;", '#' => "&#35;", '$' => "&#36;", '%' => "&#37;", '&' => "&#38;", "'" => "&#39;", '(' => "&#40;", ')' => "&#41;", 
	'*' => "&#42;", '+' => "&#43;", ',' => "&#44;", '-' => "&#45;", '.' => "&#46;", '/' => "&#47;", '0' => "&#48;", '1' => "&#49;", '2' => "&#50;", '3' => "&#51;", 
	'4' => "&#52;", '5' => "&#53;", '6' => "&#54;", '7' => "&#55;", '8' => "&#56;", '9' => "&#57;", ':' => "&#58;", ';' => "&#59;", '<' => "&#60;", '=' => "&#61;", 
	'>' => "&#62;", '?' => "&#63;", '@' => "&#64;", 'A' => "&#65;", 'B' => "&#66;", 'C' => "&#67;", 'D' => "&#68;", 'E' => "&#69;", 'F' => "&#70;", 'G' => "&#71;", 
	'H' => "&#72;", 'I' => "&#73;", 'J' => "&#74;", 'K' => "&#75;", 'L' => "&#76;", 'M' => "&#77;", 'N' => "&#78;", 'O' => "&#79;", 'P' => "&#80;", 'Q' => "&#81;", 
	'R' => "&#82;", 'S' => "&#83;", 'T' => "&#84;", 'U' => "&#85;", 'V' => "&#86;", 'W' => "&#87;", 'X' => "&#88;", 'Y' => "&#89;", 'Z' => "&#90;", '[' => "&#91;", 
	']' => "&#93;", '^' => "&#94;", '_' => "&#95;", '`' => "&#96;", 'a' => "&#97;", 'b' => "&#98;", 'c' => "&#99;", 'd' => "&#100;", 'e' => "&#101;", 'f' => "&#102;", 
	'g' => "&#103;", 'h' => "&#104;", 'i' => "&#105;", 'j' => "&#106;", 'k' => "&#107;", 'l' => "&#108;", 'm' => "&#109;", 'n' => "&#110;", 'o' => "&#111;", 'p' => "&#112;", 
	'q' => "&#113;", 'r' => "&#114;", 's' => "&#115;", 't' => "&#116;", 'u' => "&#117;", 'v' => "&#118;", 'w' => "&#119;", 'x' => "&#120;", 'y' => "&#121;", 'z' => "&#122;", 
	'{' => "&#123;", '|' => "&#124;", '}' => "&#125;"); // '\' => "&#92;"
	
	function th2uni($sti) {
		global $th2unimap, $th2unimap2, $th2unimap3, $th2unimap4, $th2unimap5;
		$sto = '';
		$len = strlen($sti);
		for ($i = 0; $i < $len; $i++) {
			if ($th2unimap[$sti{$i}]) {
				if ($i < $len && in_array($sti{$i}, Array('ญ','ฐ')) && in_array($sti{$i+1}, Array('ู','ุ','ฺ'))) {
					$sto .= $th2unimap5[$sti{$i}];
				}
				elseif ($i > 1 && in_array($sti{$i-2}, Array('ป','ฝ','ฟ')) && 
					   ($sti{$i-1} == 'ั'  || ($sti{$i-1} >= 'ิ' && $sti{$i-1} <= 'ื')) &&
					   $th2unimap4[$sti{$i}]) {
					$sto .= $th2unimap4[$sti{$i}];
				}
				elseif ($i > 0) {
					if (in_array($sti{$i-1}, Array('ป','ฝ','ฟ')) && $th2unimap3[$sti{$i}])
						$sto .= $th2unimap3[$sti{$i}];
					elseif (!($sti{$i-1} == 'ั'  || ($sti{$i-1} >= 'ิ' && $sti{$i-1} <= 'ื')) && $th2unimap2[$sti{$i}])
						$sto .= $th2unimap2[$sti{$i}];
					else
						$sto .= $th2unimap[$sti{$i}];
				}
				else
					$sto .= $th2unimap[$sti{$i}];
			}
			else
				$sto .= $sti{$i};
		}
		return $sto;
	}
	
	function uni2th($str_uni, $str_th) {
		global $th2unimap, $th2unimap2, $th2unimap3, $th2unimap4, $th2unimap5, $th2unimap6;
		
		$uni2th_trans = array_flip($th2unimap);
		$str_uni = strtr($str_uni, $uni2th_trans);
		
		$uni2th_trans = array_flip($th2unimap2);
		$str_uni = strtr($str_uni, $uni2th_trans);
		
		$uni2th_trans = array_flip($th2unimap3);
		$str_uni = strtr($str_uni, $uni2th_trans);
		
		$uni2th_trans = array_flip($th2unimap4);
		$str_uni = strtr($str_uni, $uni2th_trans);
		
		$uni2th_trans = array_flip($th2unimap5);
		$str_uni = strtr($str_uni, $uni2th_trans);
		
		$uni2th_trans = array_flip($th2unimap6);
		$str_uni = strtr($str_uni, $uni2th_trans);
		
		return $str_uni;
	}
	/*function uni2th($sti, $sto) {
		global $th2unimap, $th2unimap2, $th2unimap3, $th2unimap4, $th2unimap5;
		//echo $sti;
		$len = strlen($sti);
		if($len > 0) {
			$char = substr($sti, 0, -($len - strpos($sti, '&', 1)));
			if(in_array($char, $th2unimap)) {
				$sto .= array_search($char, $th2unimap);
			} else if(in_array($char, $th2unimap2)) {
				$sto .= array_search($char, $th2unimap2);
			} else if(in_array($char, $th2unimap3)) {
				$sto .= array_search($char, $th2unimap3);
			} else if(in_array($char, $th2unimap4)) {
				$sto .= array_search($char, $th2unimap4);
			} else if(in_array($char, $th2unimap5)) {
				$sto .= array_search($char, $th2unimap5);
			}
			if(substr_count($sti, '&') > 1) {
				$sti = substr($sti, strpos($sti, '&', 1));
				$sto = uni2th($sti, $sto);
			} else {
				$char =$sti;
				if(in_array($char, $th2unimap)) {
					$sto .= array_search($char, $th2unimap);
				} else if(in_array($char, $th2unimap2)) {
					$sto .= array_search($char, $th2unimap2);
				} else if(in_array($char, $th2unimap3)) {
					$sto .= array_search($char, $th2unimap3);
				} else if(in_array($char, $th2unimap4)) {
					$sto .= array_search($char, $th2unimap4);
				} else if(in_array($char, $th2unimap5)) {
					$sto .= array_search($char, $th2unimap5);
				}
			}
		}
		return $sto;
	}*/
	
?>